install.packages("RSQLite")
library(DBI)
#Paquetes a utilizar
library(tinytex)
library(DBI)
library(RSQLite)
#BBDD
futbol <- dbConnect(RSQLite::SQLite(), dbname = "Fútbol Europeo BBDD.sqlite")
#Paquetes a utilizar
library(tinytex)
library(DBI)
library(RSQLite)
#BBDD
futbol <- dbConnect(RSQLite::SQLite(), dbname = "Fútbol Europeo BBDD.sqlite")
tablas <- dbListTables(futbol)
print(tablas)
futbol <- dbConnect(SQLite(), dbname = "Fútbol Europeo BBDD.sqlite")
tablas <- dbListTables(futbol)
print(tablas)
tablas <- dbListTables(futbol)
print(tablas)
futbol <- dbConnect(SQLite(), dbname = "Fútbol Europeo BBDD.sqlite")
tablas <- dbListTables(futbol, "Partidos")
print(tablas)
#Paquetes a utilizar
library(tinytex)
library(DBI)
library(RSQLite)
#BBDD
futbol <- dbConnect(SQLite(), dbname = "Fútbol Europeo BBDD.sqlite")
tablas <- dbListTables(futbol, "Partidos")
print(tablas)
#BBDD
futbol <- dbConnect(SQLite(), dbname = "Fútbol Europeo BBDD.sqlite")
tablas <- dbListTables(futbol, "Partidos")
print(tablas)
futbol <- dbConnect(SQLite(), dbname = "Futbol_Europeo_BBDD.sqlite")
tablas <- dbListTables(futbol, "Partidos")
print(tablas)
#Paquetes a utilizar
library(tinytex)
library(DBI)
library(RSQLite)
library(tidyverse)
library(kableExtra)
#BBDD
futbol <- dbConnect(SQLite(), dbname = "Fútbol Europeo BBDD.sqlite")
#Funciones
moda<- function(x) {
return(as.numeric(names(which.max(table(x)))))
}
#Tablas de la BBDD
Divisiones <- dbGetQuery(futbol, "SELECT * FROM Divisiones")
Partidos <- dbGetQuery(futbol, "SELECT * FROM Partidos")
#variables
v_ath <- dbGetQuery(futbol,
"SELECT * FROM (SELECT Id_Partidos, Team_Local AS Equipo, Ganador
FROM Partidos
WHERE Cod_Division='SP1' AND Team_Local='Ath Bilbao'
UNION
SELECT * FROM Obj_1)
ORDER BY Ganador")
v_ath <- v_ath %>% mutate(Lugar = case_when(Equipo == "Ath Bilbao" ~ "Local", Equipo == "Ath Bilbao." ~ "Visitante")) %>% mutate(Ganador = recode(Ganador, "E" = "Empate", "L" = "Local", "V" = "Visitante"))
v_man <- dbGetQuery(futbol,
"SELECT * FROM (SELECT Id_Partidos, Team_Local AS Equipo, Ganador
FROM Partidos
WHERE Cod_Division='E0' AND Team_Local='Man City'
UNION
SELECT * FROM Obj_12)
ORDER BY Ganador")
v_man <- v_man %>% mutate(Lugar = case_when(Equipo == "Man City" ~ "Local", Equipo == "Man City." ~ "Visitante")) %>% mutate(Ganador = recode(Ganador, "E" = "Empate", "L" = "Local", "V" = "Visitante"))
#Para ultimo objetivo
#goles_athletic_local <- dbGetQuery(futbol, "SELECT * FROM laliga_2017_2018
#	WHERE Team_Local='Ath Bilbao'")
remove(Divisiones)
Tabla <- v_ath %>% group_by_(Lugar, Ganador) %>% summarise(Total = n()) %>%
mutate(Porcentaje = round(Total/sum(Total)*100, 1))
View(v_ath)
Tabla <- v_ath %>% group_by_("Lugar", "Ganador") %>% summarise(Total = n()) %>%
mutate(Porcentaje = round(Total/sum(Total)*100, 1))
Tabla <- v_ath %>% group_by_('Lugar', 'Ganador') %>% summarise(Total = n()) %>%
mutate(Porcentaje = round(Total/sum(Total)*100, 1))
Tabla <- v_ath %>% group_by_('Lugar.groups', 'Ganador') %>% summarise(Total = n()) %>%
mutate(Porcentaje = round(Total/sum(Total)*100, 1))
Tabla <- v_ath %>% group_by_('Lugar'.groups, 'Ganador') %>% summarise(Total = n()) %>%
Tabla <- v_ath %>% group_by_(Lugar, Ganador)
v_man <- v_man %>% mutate(Lugar= case_when(Equipo == "Man City" ~ "Local", Equipo == "Man City." ~ "Visitante")) %>% mutate(Ganador = recode(Ganador, "E" = "Empate", "L" = "Local", "V" = "Visitante"))
v_ath <- v_ath %>% mutate(Lugar= case_when(Equipo == "Ath Bilbao" ~ "Local", Equipo == "Ath Bilbao." ~ "Visitante")) %>% mutate(Ganador = recode(Ganador, "E" = "Empate", "L" = "Local", "V" = "Visitante"))
Tabla <- v_ath %>% group_by_(Lugar, Ganador) %>% summarise(Total = n()) %>%
mutate(Porcentaje = round(Total/sum(Total)*100, 1))
View(v_ath)
Tabla <- v_ath %>% group_by_(Lugar)
Tabla <- v_ath %>% group_by_("Lugar")
```{r Bar_frec_Athletic, echo=FALSE}
Tabla <- v_ath %>% group_by_("Lugar", Ganador) %>% summarise(Total = n()) %>%
mutate(Porcentaje = round(Total/sum(Total)*100, 1))
Tabla <- v_ath %>% group_by_(Lugar, Ganador) %>% summarise(Total = n()) %>%
mutate(Porcentaje = round(Total/sum(Total)*100, 1))
Tabla <- v_ath %>% group_by(Lugar, Ganador) %>% summarise(Total = n()) %>%
mutate(Porcentaje = round(Total/sum(Total)*100, 1))
View(Tabla)
Tabla <- v_ath %>% group_by(Lugar, Ganador) %>% summarise(Total = n()) %>%
mutate(Porcentaje = round(Total/sum(Total)*100, 1))
ggplot(Tabla, aes(x=Lugar, fill=Ganador)) + geom_bar(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Athletic Club de Bilbao") + theme_test() + ylim(c(0,160)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB")) +
Tabla <- v_ath %>% group_by(Lugar, Ganador) %>% summarise(Total = n()) %>%
mutate(Porcentaje = round(Total/sum(Total)*100, 1))
ggplot(Tabla, aes(x=Lugar, fill=Ganador)) + geom_bar(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Athletic Club de Bilbao") + theme_test() + ylim(c(0,160)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB"))
ggplot(Tabla, aes(x=Lugar, y="Frecuencias \n (Porcentajes)")) + geom_bar(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Athletic Club de Bilbao") + theme_test() + ylim(c(0,160)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB"))
Tabla <- v_ath %>% group_by(Lugar, Ganador) %>% summarise(Total = n()) %>%
mutate(Porcentaje = round(Total/sum(Total)*100, 1))
ggplot(Tabla, aes(x=Lugar, y=Total, fill=ganador)) + geom_bar(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Athletic Club de Bilbao") + theme_test() + ylim(c(0,160)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB"))
ggplot(Tabla, aes(x=Lugar, y=Total, fill=Ganador)) + geom_bar(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Athletic Club de Bilbao") + theme_test() + ylim(c(0,160)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB"))
ggplot(Tabla, aes(x=Lugar, y=Total, fill=Ganador)) + geom_col(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Athletic Club de Bilbao") + theme_test() + ylim(c(0,160)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB"))
ggplot(Tabla, aes(x=Lugar, y=Total, fill=Ganador)) + geom_col(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Athletic Club de Bilbao") + theme_bw() + ylim(c(0,160)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB"))
ggplot(Tabla, aes(x=Lugar, y=Total, fill=Ganador)) + geom_col(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Athletic Club de Bilbao") + theme_bw() + ylim(c(0,160)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB")) + geom_text(aes(label=paste0(Total," ", "", "(", Porcentaje, "%", ")")),  #23
vjust=-0.9,
color="black",
hjust=0.5)
ggplot(Tabla, aes(x=Lugar, y=Total, fill=Ganador)) + geom_col(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Athletic Club de Bilbao") + theme_bw() + ylim(c(0,160)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB")) + geom_text(aes(label=paste0(Total," ", "", "(", Porcentaje, "%", ")")),  #23
vjust=-0.9,
color="black",
hjust=0.5,
position=position_dodge(0.9),
vjust=-0.3,
size=3.5)
ggplot(Tabla, aes(x=Lugar, y=Total, fill=Ganador)) + geom_col(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Athletic Club de Bilbao") + theme_bw() + ylim(c(0,160)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB")) + geom_text(aes(label=paste0(Total," ", "", "(", Porcentaje, "%", ")")),
vjust=1,
color="black",
hjust=0.5,
position=position_dodge(0.9),
vjust=-0.3,
size=3.5)
```
ggplot(Tabla, aes(x=Lugar, y=Total, fill=Ganador)) + geom_col(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Athletic Club de Bilbao") + theme_bw() + ylim(c(0,160)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB")) + geom_text(aes(label=paste0(Total," ", "", "(", Porcentaje, "%", ")")),
vjust=-0.3,
color="black",
hjust=0.5,
position=position_dodge(0.9),
vjust=-0.3,
size=3.5)
ggplot(Tabla, aes(x=Lugar, y=Total, fill=Ganador)) + geom_col(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Athletic Club de Bilbao") + theme_bw() + ylim(c(0,160)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB")) + geom_text(aes(label=paste0(Total," ", "", "(", Porcentaje, "%", ")")),
vjust=-0.4,
color="black",
hjust=2,
position=position_dodge(0.9),
size=3.5)
ggplot(Tabla, aes(x=Lugar, y=Total, fill=Ganador)) + geom_col(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Athletic Club de Bilbao") + theme_bw() + ylim(c(0,160)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB")) + geom_text(aes(label=paste0(Total," ", "", "(", Porcentaje, "%", ")")),
vjust=-0.4,
color="black",
hjust=0.5)
ggplot(Tabla, aes(x=Lugar, y=Total, fill=Ganador)) + geom_col(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Athletic Club de Bilbao") + theme_bw() + ylim(c(0,160)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB")) + geom_text(aes(label=paste0(Total," ", "", "(", Porcentaje, "%", ")")),
vjust=-0.4,
color="black",
hjust=0.5,
position=position_dodge(0.9),
size=3.5)
Tabla <- v_man %>% group_by(Lugar, Ganador) %>% summarise(Total = n()) %>%
mutate(Porcentaje = round(Total/sum(Total)*100, 1))
ggplot(Tabla, aes(x=Lugar, y=Total, fill=Ganador)) + geom_col(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Manchester City") + theme_bw() + ylim(c(0,160)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB")) +
geom_text(aes(label=paste0(Total," ", "", "(", Porcentaje, "%", ")")),
vjust=-0.4,
color="black",
hjust=0.5,
position=position_dodge(0.9),
size=3.5)
View(Tabla)
ggplot(Tabla, aes(x=Lugar, y=Total, fill=Ganador)) + geom_col(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Manchester City") + theme_bw() + ylim(c(0,160)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB")) +
geom_text(aes(label=paste0(Total," ", "", "(", Porcentaje, "%", ")")),
vjust=-0.4,
color="black",
hjust=0.5,
position=position_dodge(0.9),
size=3.5)
mutate(Porcentaje = round(Total/sum(Total)*100, 1))
Tabla <- v_man %>% group_by(Lugar, Ganador) %>% summarise(Total = n()) %>%
mutate(Porcentaje = round(Total/sum(Total)*100, 1))
Tabla <- v_ath %>% group_by(Lugar, Ganador) %>% summarise(Total = n()) %>%
mutate(Porcentaje = round(Total/sum(Total)*100, 1))
View(Tabla)
Tabla <- v_man %>% group_by(Lugar, Ganador) %>% summarise(Total = n()) %>%
mutate(Porcentaje = round(Total/sum(Total)*100, 1))
ggplot(Tabla, aes(x=Lugar, y=Total, fill=Ganador)) + geom_col(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Manchester City") + theme_bw() + ylim(c(0,160)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB")) +
geom_text(aes(label=paste0(Total," ", "", "(", Porcentaje, "%", ")")),
vjust=-0.4,
color="black",
hjust=0.5,
position=position_dodge(0.9),
size=3.5)
View(Tabla)
ggplot(Tabla, aes(x=Lugar, y=Total, fill=Ganador)) + geom_col(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Manchester City") + theme_bw() + ylim(c(0,220)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB")) +
geom_text(aes(label=paste0(Total," ", "", "(", Porcentaje, "%", ")")),
vjust=-0.4,
color="black",
hjust=0.5,
position=position_dodge(0.9),
size=3.5)
Tabla <- v_man %>% group_by(Lugar, Ganador) %>% summarise(Total = n()) %>%
mutate(Porcentaje = round(Total/sum(Total)*100, 1))
ggplot(Tabla, aes(x=Lugar, y=Total, fill=Ganador)) + geom_col(position="dodge",colour="black") + labs(y="Frecuencia") + ggtitle("Contador de Victorias en las posiciones - Manchester City") + theme_bw() + ylim(c(0,220)) + scale_fill_manual(values=c("#CE93D8", "#9C27BD", "#BA68CB")) +
geom_text(aes(label=paste0(Total," ", "", "(", Porcentaje, "%", ")")),
vjust=-0.4,
color="black",
hjust=0.5,
position=position_dodge(0.9),
size=3.5)
remove(Tabla)
